this entails more functions on nested loops
